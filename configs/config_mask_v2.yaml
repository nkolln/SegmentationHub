project_name: "paintable-surface-segmentation"
experiment_name: "mask2former_large_facade_v2"

model:
  name: "mask2former"
  num_classes: 4 # Updated to match facade dataset mapping
  pretrained: true
  encoder_name: "swin-large"  # Backbone variant
  pretrained_repo: "facebook/mask2former-swin-large-cityscapes-semantic"

training:
  batch_size: 4 
  gradient_accumulation_steps: 2 
  num_epochs: 100 
  learning_rate: 0.000001
  max_lr: 0.0001 # Increased for faster signal
  weight_decay: 0.025
  optimizer: "adamw"
  scheduler: "onecycle"
  warmup_ratio: 0.3 
  seed: 42
  use_amp: true
  early_stopping_patience: 20
  max_grad_norm: 1.0 
  
  # Encoder freezing options
  freeze_encoder: true           
  unfreeze_epoch: 5 # Earlier unfreezing
  encoder_lr_mult: 0.05 # Stronger backbone gradient
  use_tta: true 

loss:
  cross_entropy: 1.0
  dice: 1.0 # Restored strong shape signal         
  focal:
    weight: 1.0      
    alpha: 0.25
    gamma: 2.0
  boundary: 0.1      
  label_smoothing: 0.1
  ignore_index: 255

data:
  root_dir: "data"
  sources: ["base", "extended"]
  image_size: 512
  train_split: 0.8
  val_split: 0.1
  test_split: 0.1
  num_workers: 4

logging:
  use_wandb: true
  log_every_n_steps: 5
  save_checkpoint_every_n_epochs: 5
  output_dir: "outputs/mask2former_large"

monitoring:
  track_gradients: true
  gradient_log_frequency: 10
  visualize_predictions_every_n_epochs: 5
